<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>Sample Multi WasmXorshift</title>
<script>
document.addEventListener( 'DOMContentLoaded', () =>
{
	const p = fetch( './xos.wasm' )
		.then( ( result ) => { return result.arrayBuffer(); } )
		.catch( () =>
		{
			// xos.wasm binary.
			return Uint8Array.from( [
				0x00,0x61,0x73,0x6D,0x01,0x00,0x00,0x00,0x01,0x13,0x04,0x60,0x00,0x00,0x60,0x04,
				0x7F,0x7F,0x7F,0x7F,0x00,0x60,0x00,0x01,0x7C,0x60,0x01,0x7F,0x00,0x03,0x09,0x08,
				0x00,0x01,0x02,0x02,0x00,0x00,0x01,0x03,0x04,0x04,0x01,0x70,0x00,0x01,0x05,0x03,
				0x01,0x00,0x00,0x06,0x3C,0x09,0x7F,0x00,0x41,0x95,0x9A,0xEF,0x3A,0x0B,0x7F,0x00,
				0x41,0xE5,0xAB,0xE9,0xAC,0x01,0x0B,0x7F,0x00,0x41,0xB5,0xF7,0xC8,0xF8,0x01,0x0B,
				0x7F,0x00,0x41,0xB3,0xA6,0xA4,0x2A,0x0B,0x7F,0x01,0x41,0x00,0x0B,0x7F,0x01,0x41,
				0x00,0x0B,0x7F,0x01,0x41,0x00,0x0B,0x7F,0x01,0x41,0x00,0x0B,0x7F,0x01,0x41,0x00,
				0x0B,0x07,0x3E,0x09,0x06,0x6D,0x65,0x6D,0x6F,0x72,0x79,0x02,0x00,0x01,0x58,0x03,
				0x00,0x01,0x59,0x03,0x01,0x01,0x5A,0x03,0x02,0x01,0x57,0x03,0x03,0x09,0x5F,0x5F,
				0x73,0x65,0x74,0x61,0x72,0x67,0x63,0x00,0x07,0x04,0x73,0x65,0x65,0x64,0x00,0x06,
				0x07,0x6E,0x65,0x78,0x74,0x49,0x6E,0x74,0x00,0x02,0x04,0x6E,0x65,0x78,0x74,0x00,
				0x03,0x08,0x01,0x04,0x09,0x07,0x01,0x00,0x41,0x00,0x0B,0x01,0x05,0x0A,0xE1,0x01,
				0x08,0x12,0x00,0x23,0x00,0x24,0x04,0x23,0x01,0x24,0x05,0x23,0x02,0x24,0x06,0x23,
				0x03,0x24,0x07,0x0B,0x43,0x00,0x20,0x00,0x45,0x04,0x7F,0x20,0x01,0x45,0x05,0x41,
				0x00,0x0B,0x04,0x7F,0x20,0x02,0x45,0x05,0x41,0x00,0x0B,0x04,0x7F,0x20,0x03,0x45,
				0x05,0x41,0x00,0x0B,0x04,0x40,0x23,0x00,0x21,0x00,0x23,0x01,0x21,0x01,0x23,0x02,
				0x21,0x02,0x23,0x03,0x21,0x03,0x0B,0x20,0x00,0x24,0x04,0x20,0x01,0x24,0x05,0x20,
				0x02,0x24,0x06,0x20,0x03,0x24,0x07,0x0B,0x30,0x01,0x01,0x7F,0x23,0x04,0x23,0x04,
				0x41,0x0B,0x74,0x73,0x21,0x00,0x23,0x05,0x24,0x04,0x23,0x06,0x24,0x05,0x23,0x07,
				0x24,0x06,0x23,0x07,0x23,0x07,0x41,0x13,0x76,0x73,0x20,0x00,0x20,0x00,0x41,0x08,
				0x76,0x73,0x73,0x24,0x07,0x23,0x07,0xB8,0x0B,0x0E,0x00,0x10,0x02,0x44,0x00,0x00,
				0xE0,0xFF,0xFF,0xFF,0xEF,0x41,0xA3,0x0B,0x04,0x00,0x10,0x00,0x0B,0x02,0x00,0x0B,
				0x39,0x00,0x02,0x40,0x02,0x40,0x02,0x40,0x02,0x40,0x02,0x40,0x02,0x40,0x23,0x08,
				0x0E,0x05,0x01,0x02,0x03,0x04,0x05,0x00,0x0B,0x00,0x0B,0x41,0x00,0x21,0x00,0x0B,
				0x41,0x00,0x21,0x01,0x0B,0x41,0x00,0x21,0x02,0x0B,0x41,0x00,0x21,0x03,0x0B,0x20,
				0x00,0x20,0x01,0x20,0x02,0x20,0x03,0x10,0x01,0x0B,0x06,0x00,0x20,0x00,0x24,0x08,
				0x0B ] ).buffer;
		} )
		.then( ( bytes ) =>
		{
			return function( importObject = {} )
			{
				this.ready = WebAssembly.instantiate( bytes, importObject ).then( ( mod ) =>
				{
					this.seed = mod.instance.exports.seed;
					this.nextInt = mod.instance.exports.nextInt;
					this.next = mod.instance.exports.next;
					return this;
				} );
			};
		} ).then( ( XorShift ) =>
		{
			return Promise.all( [ new XorShift().ready, new XorShift().ready ] );
		} ).then( ( result ) =>
		{
			const xos1 = result[ 0 ];
			const result1 = document.getElementById( 'result1' );
			document.getElementById( 'next1' ).addEventListener( 'click', () => { result1.value = '0x' + xos1.nextInt().toString( 16 ); } );
			const xos2 = result[ 1 ];
			const result2 = document.getElementById( 'result2' );
			document.getElementById( 'next2' ).addEventListener( 'click', () => { result2.value = '0x' + xos2.nextInt().toString( 16 ); } );
		} );
} );
</script>
</head>
<body>
	<div style="width:80%;margin:auto">
		Xorshift1:
		<input type="text" id="result1" readonly>
		<button id="next1">Next</button>
	</div>
	<div style="width:80%;margin:auto">
		Xorshift2:
		<input type="text" id="result2" readonly>
		<button id="next2">Next</button>
	</div>
</body>
</html>
